<!DOCTYPE html>
<html>
<head>
    <title>Test App for Offline Storage</title>

    <script type="text/javascript" charset="utf-8" src="../lib/tiles/phoneGapConnector.js"></script>
    <script type="text/javascript" charset="utf-8" src="../samples/phonegap/cordova.js"></script>
    <script type="text/javascript" charset="utf-8">

        var phonegap = null

        // Wait for device API libraries to load
        //
        document.addEventListener("deviceready", onDeviceReady, false);

        // device APIs are available
        //

        function onDeviceReady(){

            phonegap = new PhoneGapConnector();

            document.addEventListener(phonegap.enum().SQL_ERROR_EVENT,function(evt){

                alert("SQL Error: " + evt.detail.message);
//                        switch(evt.detail.message){
//                            case "database error":
//                                alert("A database error occurred.");
//                                break;
//                            case "Path exists error":
//                                fileExists = true;
//                                break;
//                            case "file open success":
//                                //File ready for read/write
//                                break;
//                        }
                },
                false);

            phonegap.init(200000,function(success,event){
                console.log("Tiles database is ready: " + success);
            });
        }

        function setUrl(){
            phonegap.setUrl('8b','test',function(success,value,url){
                if(success == false){
                    console.log("Tile did not get added to database:  " + value.code +
                            ", " + value.message  +
                            ", " + url);
                }
            })

            phonegap.setUrl('8c','test',function(success,value,url){
                if(success == false){
                    console.log("Tile did not get added to database:  " + value.code +
                            ", " + value.message  +
                            ", " + url);
                }
            })
        }

        function getTile(url){
            phonegap.getTile(url,function(test,val){
                if(test == null && val != null){
                    alert("Success: " + test + ", " + val);
                }
                else if(test == null && val == null){
                    alert("Nothing found");
                }
                else{
                    alert("SQL Error: " + val.code + ", " + val.message);
                }
            })
        }

        function deleteDB(){
            phonegap.deleteDB(function(val,result){
                if(val == true){
                    alert("DB successfully deleted");
                }
                else{
                    alert("DB deletion error: " + result.code + ", " + result.message);
                }
            });
        }

        function getSize(){
            var info;
            phonegap.getDBCount(function(result,err){
                if(result != null){
                    info = result;
                }
                else{
                    info = err;
                }

                console.log("Size: " + info);
            });
        }

        function getVersion(){
            alert("Version: " + phonegap.getDBVersion());
        }

    </script>
</head>
<body>
<h1>Example</h1>
<p>Local File System</p>
<button onclick="setUrl()">add item</button><br><br>
<button onclick="getTile('8b')">get item</button><br><br>
<button onclick="getSize()">get Size</button><br><br>
<button onclick="getVersion()">get Version</button><br><br>
<button onclick="deleteDB()">delete DB</button>
</body>
</html>